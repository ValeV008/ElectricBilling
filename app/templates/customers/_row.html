<tr id="cust-{{ c.id }}">
  <td class="p-2">{{ c.name }}</td>
  <td class="p-2 text-left w-1/3">
  <form method="post" action="/invoices/{{ c.id }}" target="_blank">
      <select id="billing_month_{{ c.id }}" class="border rounded px-2 py-1">
        {% if c.months and c.months|length > 0 %}
          {% for month in c.months %}
            <option value="{{ month }}">{{ month }}</option>
          {% endfor %}
        {% else %}
          <option disabled value="">No data</option>
        {% endif %}
  </select>
  <input type="hidden" name="year_month" id="billing_year_month_{{ c.id }}" />
  <button id="generate_pdf_{{ c.id }}" type="submit" class="ml-2 px-2 py-1 bg-blue-500 text-white rounded">Generate PDF</button>
      <script>
        (function(){
          try {
            var sel = document.getElementById('billing_month_{{ c.id }}');
            var btn = document.getElementById('generate_pdf_{{ c.id }}');
            if (!sel || !btn) return;
            function update() {
              var v = (sel.value || '').toString().trim();
              var disabled = v.length === 0;
              btn.disabled = disabled;
              if (disabled) {
                btn.classList.remove('bg-blue-500', 'cursor-pointer');
                btn.classList.add('bg-gray-400', 'cursor-not-allowed');
              } else {
                btn.classList.add('bg-blue-500', 'cursor-pointer');
                btn.classList.remove('bg-gray-400', 'cursor-not-allowed');
              }
            }
            sel.addEventListener('change', update);
            update();
            var form = sel.closest('form');
            if (form) form.addEventListener('submit', function(){
              var hidden = document.getElementById('billing_year_month_{{ c.id }}');
              if (hidden) hidden.value = (sel.value || '').toString().trim();
            });
          } catch (e) {
            console && console.error && console.error('init billing_month control error', e);
          }
        })();
      </script>
    </form>
  </td>
</tr>
